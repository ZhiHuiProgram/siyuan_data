{"ID":"20250526153143-qmt5w8b","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250526153143-qmt5w8b","title":"触发信号位置","type":"doc","updated":"20250813153324"},"Children":[{"ID":"20250526153143-ps4jaai","Type":"NodeParagraph","Properties":{"id":"20250526153143-ps4jaai","updated":"20250526153210"},"Children":[{"Type":"NodeText","Data":"gdb"}]},{"ID":"20250526153210-y0j2fph","Type":"NodeParagraph","Properties":{"id":"20250526153210-y0j2fph","updated":"20250526153210"},"Children":[{"Type":"NodeText","Data":"handle SIGPIPE stop print"}]},{"ID":"20250526153213-uypyeza","Type":"NodeParagraph","Properties":{"id":"20250526153213-uypyeza","updated":"20250526153214"},"Children":[{"Type":"NodeText","Data":"run"}]},{"ID":"20250731182817-w9qd0w6","Type":"NodeParagraph","Properties":{"id":"20250731182817-w9qd0w6","updated":"20250731182817"}},{"ID":"20250731182820-kku29fe","Type":"NodeParagraph","Properties":{"id":"20250731182820-kku29fe","updated":"20250813153303"},"Children":[{"Type":"NodeText","Data":"查看崩溃信息 arm-fhva12c-linux-uclibcgnueabihf-addr2line -f -p -e sample_vlcview  0x10558  或者"}]},{"ID":"20250813153245-brhdqax","Type":"NodeParagraph","Properties":{"id":"20250813153245-brhdqax","updated":"20250813153246"},"Children":[{"Type":"NodeText","Data":"arm-fhva12c-linux-uclibcgnueabihf-gdb -q sample_vlcview   -ex \"set pagination off\"   -ex \"info line *0x3880e\"   -ex \"disassemble 0x38800,0x38830\"   -ex \"quit\""}]},{"ID":"20250731182834-jh1fpoo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250731182834-jh1fpoo","updated":"20250813153324"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"static void generic_signal_handler(int signum, siginfo_t *info, void *context)\n{\n    ucontext_t *uc = (ucontext_t *)context;\n\n#if defined(__arm__)\n    void *pc = (void *)uc-\u003euc_mcontext.arm_pc;\n    void *lr = (void *)((uintptr_t)uc-\u003euc_mcontext.arm_lr \u0026 ~1u);\n    void *sp = (void *)uc-\u003euc_mcontext.arm_sp;\n#elif defined(__aarch64__)\n    void *pc = (void *)uc-\u003euc_mcontext.pc;\n    void *lr = (void *)((uintptr_t)uc-\u003euc_mcontext.arm_lr \u0026 ~1u);\n    void *sp = (void *)uc-\u003euc_mcontext.arm_sp;\n#elif defined(__i386__)\n    void *pc = (void *)uc-\u003euc_mcontext.gregs[REG_EIP];\n    void *lr = (void *)((uintptr_t)uc-\u003euc_mcontext.arm_lr \u0026 ~1u);\n    void *sp = (void *)uc-\u003euc_mcontext.arm_sp;\n#elif defined(__x86_64__)\n    void *pc = (void *)uc-\u003euc_mcontext.gregs[REG_RIP];\n    void *lr = (void *)((uintptr_t)uc-\u003euc_mcontext.arm_lr \u0026 ~1u);\n    void *sp = (void *)uc-\u003euc_mcontext.arm_sp;\n#else\n    void *pc = NULL;\n#endif\n\n    dprintf(2, \"\\n[!] Caught signal: %d (%s)\\n\", signum, strsignal(signum));\n    dprintf(2, \"[!] Fault address: %p\\n\", info ? info-\u003esi_addr : NULL);\n    dprintf(2, \"[!] PC at crash   : %p\\n\", pc);\n    dprintf(2, \"[!] PC=%p  LR=%p  SP=%p\\n\", pc, lr, sp);\n    dprintf(2, \"[!] addr2line -e sample_vlcview %#lx\\n\", (unsigned long)pc);\n\n    signal(signum, SIG_DFL);\n    raise(signum);\n}\nvoid setup_signal_handlers()\n{\n    struct sigaction sa;\n    sa.sa_sigaction = generic_signal_handler;\n    sigemptyset(\u0026sa.sa_mask);\n    sa.sa_flags = SA_SIGINFO;\n\n    int signals[] = {\n        SIGSEGV, SIGBUS, SIGFPE, SIGILL, SIGABRT,\n        SIGHUP, SIGINT, SIGIOT, SIGPIPE, SIGQUIT,\n        SIGSYS, SIGTERM, SIGTRAP, SIGUSR1, SIGUSR2\n        // 注：SIGKILL 和 SIGSTOP 无法捕获\n    };\n\n    for (int i = 0; i \u003c sizeof(signals) / sizeof(signals[0]); i++)\n    {\n        if (sigaction(signals[i], \u0026sa, NULL) != 0)\n        {\n            fprintf(stderr, \"[!] Failed to register handler for signal %d (%s)\\n\", signals[i], strsignal(signals[i]));\n        }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}
{"ID":"20250402143501-u8trb85","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250402143501-u8trb85","title":"4月","type":"doc","updated":"20250427202804"},"Children":[{"ID":"20250402143501-5vxpcvw","Type":"NodeParagraph","Properties":{"id":"20250402143501-5vxpcvw","updated":"20250415201845"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"font-size: 16px;"},"TextMarkType":"text","TextMarkTextContent":"4.1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"font-size: 16px;\"}"}]},{"ID":"20250415201947-tkfu8ap","Type":"NodeParagraph","Properties":{"id":"20250415201947-tkfu8ap","updated":"20250415201947"},"Children":[{"Type":"NodeText","Data":"查看手册测试摄像头转夜视代码，可以实现转夜视功能，将t32摄像头获取的数据加入环形缓冲区，保存视频数据正常的但有些失真，暂时没4g模块测试。"}]},{"ID":"20250415201543-3t36tip","Type":"NodeParagraph","Properties":{"id":"20250415201543-3t36tip","updated":"20250415201741"},"Children":[{"Type":"NodeText","Data":"4.2"}]},{"ID":"20250415201952-0pfbhtv","Type":"NodeParagraph","Properties":{"id":"20250415201952-0pfbhtv","updated":"20250415201952"},"Children":[{"Type":"NodeText","Data":"排查出两个视频流获取进程，解决后视频不失真播放正常，更换yolo模型加快推理，效果不佳，暂时采用原模型推理。"}]},{"ID":"20250415201704-dspbyvc","Type":"NodeParagraph","Properties":{"id":"20250415201704-dspbyvc","updated":"20250415201733"},"Children":[{"Type":"NodeText","Data":"4.3"}]},{"ID":"20250415201953-g8jkotn","Type":"NodeParagraph","Properties":{"id":"20250415201953-g8jkotn","updated":"20250415201953"},"Children":[{"Type":"NodeText","Data":"参考sample移动侦测代码，将移动侦测代码移植到t32工程内，开发板4功能测试无误，目前代码整合完，打包到固件会超分区，还需调整分区。"}]},{"ID":"20250415201732-jz0kpto","Type":"NodeParagraph","Properties":{"id":"20250415201732-jz0kpto","updated":"20250415202005"},"Children":[{"Type":"NodeText","Data":"4.7"}]},{"ID":"20250415201956-5c2ni5j","Type":"NodeParagraph","Properties":{"id":"20250415201956-5c2ni5j","updated":"20250415202012"},"Children":[{"Type":"NodeText","Data":"更改分区与uboot的配置，排查开启ttys0串口内核无法启动是引脚冲突，开始推流出现sip启动不了，在电脑客户端运行目前配置的地址可以连接服务器"}]},{"ID":"20250415202024-5tfp8jf","Type":"NodeParagraph","Properties":{"id":"20250415202024-5tfp8jf","updated":"20250415202026"},"Children":[{"Type":"NodeText","Data":"4.8"}]},{"ID":"20250415202027-ql5frna","Type":"NodeParagraph","Properties":{"id":"20250415202027-ql5frna","updated":"20250415202027"},"Children":[{"Type":"NodeText","Data":"排查sip参数消失原因，线程传参会将sip参数清空，修改后可以连接服务器但视频播放有问题，地址传参会清空线程参数，采用非传参方式也会清空，重新配置环境排查其他问题。"}]},{"ID":"20250415202028-g6cl5zm","Type":"NodeParagraph","Properties":{"id":"20250415202028-g6cl5zm","updated":"20250415202041"},"Children":[{"Type":"NodeText","Data":"4.9"}]},{"ID":"20250415202042-y84dwbe","Type":"NodeParagraph","Properties":{"id":"20250415202042-y84dwbe","updated":"20250415202042"},"Children":[{"Type":"NodeText","Data":"烧录新环境固件，测试未改过的工程代码，运行推流正常，依旧会有清空serverip，通过排查是线程传参函数越界出现ip被清空，目前检测程序可以推流服务器"}]},{"ID":"20250415202013-la92v51","Type":"NodeParagraph","Properties":{"id":"20250415202013-la92v51","updated":"20250415202054"},"Children":[{"Type":"NodeText","Data":"4.10"}]},{"ID":"20250415202054-aa1tyan","Type":"NodeParagraph","Properties":{"id":"20250415202054-aa1tyan","updated":"20250415202054"},"Children":[{"Type":"NodeText","Data":"将检测程序修改为多目标检测，同时显示多个检测框，整合移动侦测代码，目前移动侦测用在改变检测框颜色。"}]},{"ID":"20250415202104-a1shtl8","Type":"NodeParagraph","Properties":{"id":"20250415202104-a1shtl8","updated":"20250415202104"},"Children":[{"Type":"NodeText","Data":"4.11"}]},{"ID":"20250415202105-szig9o3","Type":"NodeParagraph","Properties":{"id":"20250415202105-szig9o3","updated":"20250415202105"},"Children":[{"Type":"NodeText","Data":"查看libyuv源码，调用i420转换及nv12互相转换代码，对nv12图片进行裁剪缩放，在t32上调用随机数会有write函数报错，直接赋值可以正常运行循环"}]},{"ID":"20250415202114-nt24p01","Type":"NodeParagraph","Properties":{"id":"20250415202114-nt24p01","updated":"20250415202115"},"Children":[{"Type":"NodeText","Data":"4.12"}]},{"ID":"20250415202115-uuvjztg","Type":"NodeParagraph","Properties":{"id":"20250415202115-uuvjztg","updated":"20250415202116"},"Children":[{"Type":"NodeText","Data":"裁剪缩放函数打包完成，将裁剪宽度进行十六字节对齐后可以稳定工作，开发板端可正常循环工作，查看模型后量化过程，目前参数有误还未量化成功"}]},{"ID":"20250415202123-ul20otz","Type":"NodeParagraph","Properties":{"id":"20250415202123-ul20otz","updated":"20250415202130"},"Children":[{"Type":"NodeText","Data":"4.14"}]},{"ID":"20250415202130-2vymhhd","Type":"NodeParagraph","Properties":{"id":"20250415202130-2vymhhd","updated":"20250415202130"},"Children":[{"Type":"NodeText","Data":"查找libjpeg源码，将jpg转为argb，再转为nv12进行yolo检测，jpg可正常转换nv12，检测在yolo源码中出现段错误，报错在初始化位置。"}]},{"ID":"20250415202132-oj4wow7","Type":"NodeParagraph","Properties":{"id":"20250415202132-oj4wow7","updated":"20250415202136"},"Children":[{"Type":"NodeText","Data":"4.15"}]},{"ID":"20250415202137-pm9v44u","Type":"NodeParagraph","Properties":{"id":"20250415202137-pm9v44u","updated":"20250415202426"},"Children":[{"Type":"NodeText","Data":"排查yolo检测出现的段错误，将源码从电脑端测试后，发现模型class从80改为1，修改后在板端出现打包的yolo库报错，修改为动态链接可正常运行，目前可正常车牌识别与裁剪。"}]},{"ID":"20250427202326-6rumyit","Type":"NodeParagraph","Properties":{"id":"20250427202326-6rumyit","updated":"20250427202351"},"Children":[{"Type":"NodeText","Data":"4.16"}]},{"ID":"20250427202352-alazjkc","Type":"NodeParagraph","Properties":{"id":"20250427202352-alazjkc","updated":"20250427202352"},"Children":[{"Type":"NodeText","Data":"整理代码结构优化线程间逻辑，本地保存视频没问题，在服务器10fps比较流畅，网络质量差时会有卡顿。"}]},{"ID":"20250427202353-98ugby1","Type":"NodeParagraph","Properties":{"id":"20250427202353-98ugby1","updated":"20250427202355"},"Children":[{"Type":"NodeText","Data":"4.17"}]},{"ID":"20250427202403-q4m6swj","Type":"NodeParagraph","Properties":{"id":"20250427202403-q4m6swj","updated":"20250427202405"},"Children":[{"Type":"NodeText","Data":"缩小ringfifo大小，减小内存使用空间，熟悉工程代码gb28181部分，初始化梳理sip连接与rtp连接流程与配置"}]},{"ID":"20250427202406-zx39sle","Type":"NodeParagraph","Properties":{"id":"20250427202406-zx39sle","updated":"20250427202407"},"Children":[{"Type":"NodeText","Data":"4.18"}]},{"ID":"20250427202408-nwffjp1","Type":"NodeParagraph","Properties":{"id":"20250427202408-nwffjp1","updated":"20250427202417"},"Children":[{"Type":"NodeText","Data":"了解其他音视频传输协议，查看工程内sip和rtp调用关系，内存开销，根据demo构建sip客户端连接服务器"}]},{"ID":"20250427202426-niz4hni","Type":"NodeParagraph","Properties":{"id":"20250427202426-niz4hni","updated":"20250427202433"},"Children":[{"Type":"NodeText","Data":"4.19"}]},{"ID":"20250427202428-jyrmmps","Type":"NodeParagraph","Properties":{"id":"20250427202428-jyrmmps","updated":"20250427202429"},"Children":[{"Type":"NodeText","Data":"查看线程开销，使用内存量，查找popen导致程序bug，使用君正系统库解决，增加加载模型后清缓存，优化后可增加5-6M内存空间"}]},{"ID":"20250427202435-33739kj","Type":"NodeParagraph","Properties":{"id":"20250427202435-33739kj","updated":"20250427202451"},"Children":[{"Type":"NodeText","Data":"4.21"}]},{"ID":"20250427202446-oi5s8tc","Type":"NodeParagraph","Properties":{"id":"20250427202446-oi5s8tc","updated":"20250427202446"},"Children":[{"Type":"NodeText","Data":"优化内存占用，开启编码直通会出现参数不匹配系统不稳定。优化osd画框延迟较大问题，减小framebuffer深度，设置为1，延迟缩短为yolo检测时间0.7s左右，内存占用缩小2m左右。排查联网会出现缓存增长占用"}]},{"ID":"20250427202453-sf3xcpj","Type":"NodeParagraph","Properties":{"id":"20250427202453-sf3xcpj","updated":"20250427202502"},"Children":[{"Type":"NodeText","Data":"4.22"}]},{"ID":"20250427202503-difzt90","Type":"NodeParagraph","Properties":{"id":"20250427202503-difzt90","updated":"20250427202503"},"Children":[{"Type":"NodeText","Data":"经过排查发现调用osip的register会出现内存一直增长的情况，会占用较多内存，目前采用定时清缓存方式释放大量空间，目前可用空间在30m左右"}]},{"ID":"20250427202513-zxsem89","Type":"NodeParagraph","Properties":{"id":"20250427202513-zxsem89","updated":"20250427202514"},"Children":[{"Type":"NodeText","Data":"4.23"}]},{"ID":"20250427202514-cojhq1r","Type":"NodeParagraph","Properties":{"id":"20250427202514-cojhq1r","updated":"20250427202515"},"Children":[{"Type":"NodeText","Data":"优化内存空间，目前有50M可用空间，rmem可用空间留有8M增加后续osd功能，调整码率控制参数，SMART模式效果不佳，使用CBR模式画面质量略微提升，码率还需测试"}]},{"ID":"20250427202522-g3vuizo","Type":"NodeParagraph","Properties":{"id":"20250427202522-g3vuizo","updated":"20250427202524"},"Children":[{"Type":"NodeText","Data":"4.24"}]},{"ID":"20250427202524-q6rwqln","Type":"NodeParagraph","Properties":{"id":"20250427202524-q6rwqln","updated":"20250427202526"},"Children":[{"Type":"NodeText","Data":"了解内存管理机制，排查网络连接后内存增长原因，排除sip库，在录像保存位置write数据，fsync，o_sync无效，需要改内核参数"}]},{"ID":"20250427202538-dzugo86","Type":"NodeParagraph","Properties":{"id":"20250427202538-dzugo86","updated":"20250427202539"},"Children":[{"Type":"NodeText","Data":"4.25"}]},{"ID":"20250427202539-0r5uoj8","Type":"NodeParagraph","Properties":{"id":"20250427202539-0r5uoj8","updated":"20250427202540"},"Children":[{"Type":"NodeText","Data":"在write位置会有缓存增长，使用posixfadvise函数通知内核清无用缓存。目前程序运行内存比较稳定。查看osd2bit模式"}]},{"ID":"20250427202543-y0wkijw","Type":"NodeParagraph","Properties":{"id":"20250427202543-y0wkijw","updated":"20250427202546"},"Children":[{"Type":"NodeText","Data":"4.27"}]},{"ID":"20250427202546-gu8keve","Type":"NodeParagraph","Properties":{"id":"20250427202546-gu8keve","updated":"20250427202804"},"Children":[{"Type":"NodeText","Data":"调试osd2bit模式，目前在单独字符测试正常运行，字符宽度需要在定义宽度*4 ，字符串测试会乱码，调整uboot卡起固件，目前自动卡起读不到固件内容"}]}]}
{"ID":"20251014222805-id8l3ue","Spec":"1","Type":"NodeDocument","Properties":{"id":"20251014222805-id8l3ue","title":"可恢复的错误 Result和？","type":"doc","updated":"20251016212427"},"Children":[{"ID":"20251014222805-ud9jwlw","Type":"NodeParagraph","Properties":{"id":"20251014222805-ud9jwlw","updated":"20251014224507"},"Children":[{"Type":"NodeText","Data":"定义："}]},{"ID":"20251014224507-ymx3b25","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014224507-ymx3b25","updated":"20251014224508"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"enum Result\u003cT, E\u003e {\n    Ok(T),\n    Err(E),\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014224509-av3xsr8","Type":"NodeParagraph","Properties":{"id":"20251014224509-av3xsr8","updated":"20251014225109"},"Children":[{"Type":"NodeText","Data":"一个文件创建的例子："}]},{"ID":"20251014225109-y71q35q","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014225109-y71q35q","updated":"20251014225111"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"use std::fs::File;\nuse std::io::ErrorKind;\n\nfn main() {\n    let f = File::open(\"hello.txt\");\n\n    let f = match f {\n        Ok(file) =\u003e file,\n        Err(error) =\u003e match error.kind() {\n            ErrorKind::NotFound =\u003e match File::create(\"hello.txt\") {\n                Ok(fc) =\u003e fc,\n                Err(e) =\u003e panic!(\"Problem creating the file: {:?}\", e),\n            },\n            other_error =\u003e panic!(\"Problem opening the file: {:?}\", other_error),\n        },\n    };\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014225400-akewrji","Type":"NodeParagraph","Properties":{"id":"20251014225400-akewrji","updated":"20251014225706"},"Children":[{"Type":"NodeText","Data":"这里有一个写法：慎用，测试用，生产不建议"}]},{"ID":"20251014225407-6zwbetk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014225407-6zwbetk","updated":"20251015222210"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"\nlet f = File::open(\"hello.txt\").unwrap();  //简单粗暴 ，错了直接panic\nlet f = File::open(\"hello.txt\").expect(\"Failed to open hello.txt\"); //效果一样，但是多了一行打印\n    |\n\tV\nlet f = match File::open(\"hello.txt\") {\n    Ok(file) =\u003e file,\n    Err(error) =\u003e panic!(\"打开文件失败: {:?}\", error),\n};\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014225708-pvwzp4k","Type":"NodeParagraph","Properties":{"id":"20251014225708-pvwzp4k","updated":"20251014230016"},"Children":[{"Type":"NodeText","Data":"？：有意思"}]},{"ID":"20251014225938-p7zonnl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014225938-p7zonnl","updated":"20251015222744"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"use std::fs::File;\nuse std::io;\nuse std::io::Read;\n\nfn read_username_from_file() -\u003e Result\u003cString, io::Error\u003e {\n    let mut f = File::open(\"hello.txt\")?;   //这里出错会自动返回Err(e)；\n    let mut s = String::new();\n    f.read_to_string(\u0026mut s)?;   //读取文件所有内容\n    Ok(s)  //如果不出错自己设置返回值 这里目前设置的是String ， 可以自定义\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251015222728-ffs8dv6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251015222728-ffs8dv6","updated":"20251015222805"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"use std::fs;\nuse std::io;\nfn read_username_from_file() -\u003e Result\u003cString, io::Error\u003e {\n    fs::read_to_string(\"hello.txt\")\n    //  ^^^^^^^^^^^^^^^ 读取整个文件到 String\n    //  成功：Ok(String)\n    //  失败：Err(io::Error)\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251015222806-ygpbu8f","Type":"NodeParagraph","Properties":{"id":"20251015222806-ygpbu8f","updated":"20251015222829"},"Children":[{"Type":"NodeText","Data":"返回枚举："}]},{"ID":"20251015222829-tnwlom3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251015222829-tnwlom3","updated":"20251015222922"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"fn first(arr: \u0026[i32]) -\u003e Option\u003c\u0026i32\u003e {\n   let v = arr.get(0)?;   //这里？解析了get返回的，错误返回None ，正确返回值\n   Some(v)\n}\nBUT！！\nfn first(arr: \u0026[i32]) -\u003e Option\u003c\u0026i32\u003e {  本来就可以这样\n   arr.get(0)\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251015222923-zz174lm","Type":"NodeParagraph","Properties":{"id":"20251015222923-zz174lm","updated":"20251015231058"},"Children":[{"Type":"NodeText","Data":"好玩的："}]},{"ID":"20251015231058-87mvoe5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251015231058-87mvoe5","updated":"20251015231313"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"fn last_char_of_first_line(text: \u0026str) -\u003e Option\u003cchar\u003e {\n    text.lines().next()?.chars().last()\n}  这里lines是迭代器，遇到换行分割，next是先返回当前，在下一个，？判断，正确则chars转为按字符计算，last取最后一个字符\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251015231316-7xms8nq","Type":"NodeParagraph","Properties":{"id":"20251015231316-7xms8nq","updated":"20251015231845"},"Children":[{"Type":"NodeText","Data":"try！：刚刚看了，已经在2018被弃用了~"}]},{"ID":"20251015231509-lt3q7go","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251015231509-lt3q7go","updated":"20251015231516"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"//  `?`\nlet x = function_with_error()?; // 若返回 Err, 则立刻返回；若返回 Ok(255)，则将 x 的值设置为 255\n\n// `try!()`\nlet x = try!(function_with_error());\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251016212427-qs1fiz1","Type":"NodeParagraph","Properties":{"id":"20251016212427-qs1fiz1","updated":"20251016212427"}}]}
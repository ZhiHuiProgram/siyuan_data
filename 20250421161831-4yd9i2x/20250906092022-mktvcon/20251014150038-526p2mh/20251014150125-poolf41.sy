{"ID":"20251014150125-poolf41","Spec":"1","Type":"NodeDocument","Properties":{"id":"20251014150125-poolf41","title":"panic!深入剖析","type":"doc","updated":"20251014221655"},"Children":[{"ID":"20251014150125-1rjujj3","Type":"NodeParagraph","Properties":{"id":"20251014150125-1rjujj3","updated":"20251014163856"},"Children":[{"Type":"NodeText","Data":"主动调用与被动调用："}]},{"ID":"20251014163849-h88vzkn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014163849-h88vzkn","updated":"20251014163922"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"    let v = vec![1, 2, 3];\n    v[99];\nand\n\tpanic!(\"crash and burn\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014170932-tyausf2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251014170932-tyausf2","updated":"20251014183335"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/basic/result-error/panic.html#backtrace-%E6%A0%88%E5%B1%95%E5%BC%80","TextMarkTextContent":"backtrace 栈展开"}]},{"ID":"20251014170933-wvakzw9","Type":"NodeParagraph","Properties":{"id":"20251014170933-wvakzw9","updated":"20251014175625"},"Children":[{"Type":"NodeText","Data":"按照提示使用 RUST_BACKTRACE=1 cargo run"}]},{"ID":"20251014175631-g0kgnsd","Type":"NodeParagraph","Properties":{"id":"20251014175631-g0kgnsd","updated":"20251014183307"},"Children":[{"Type":"NodeText","Data":"开发板端："}]},{"ID":"20251014183307-kgineea","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014183307-kgineea","updated":"20251014183333"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"RUST_BACKTRACE=1 ./a.out 直接出调用信息，非常方便\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014221526-z3cm4tj","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251014221526-z3cm4tj","updated":"20251014221655"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/basic/result-error/panic.html#panic-%E6%97%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%BB%88%E6%AD%A2%E6%96%B9%E5%BC%8F","TextMarkTextContent":"panic 时的两种终止方式"}]},{"ID":"20251014221527-sazt1du","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251014221527-sazt1du","linewrap":"true","updated":"20251014221557"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"当出现 panic! 时，程序提供了两种方式来处理终止流程：栈展开和直接终止。\n其中，默认的方式就是 栈展开，这意味着 Rust 会回溯栈上数据和函数调用，因此也意味着更多的善后工作，好处是可以给出充分的报错信息和栈调用信息，便于事后的问题复盘。直接终止，顾名思义，不清理数据就直接退出程序，善后工作交与操作系统来负责。\n对于绝大多数用户，使用默认选择是最好的，但是当你关心最终编译出的二进制可执行文件大小时，那么可以尝试去使用直接终止的方式，例如下面的配置修改 Cargo.toml 文件，实现在 release 模式下遇到 panic 直接终止：\n[profile.release]\npanic = 'abort'\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251014221558-blc2q87","Type":"NodeParagraph","Properties":{"id":"20251014221558-blc2q87","style":"font-size: 25px;","updated":"20251014221642"},"Children":[{"Type":"NodeText","Data":"panic不会终止进程，而是终止线程"}]},{"ID":"20251014221655-766v9gn","Type":"NodeParagraph","Properties":{"id":"20251014221655-766v9gn","updated":"20251014221655"}}]}
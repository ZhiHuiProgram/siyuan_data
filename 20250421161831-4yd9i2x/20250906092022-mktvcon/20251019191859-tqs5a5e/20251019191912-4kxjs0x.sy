{"ID":"20251019191912-4kxjs0x","Spec":"1","Type":"NodeDocument","Properties":{"id":"20251019191912-4kxjs0x","title":"生命周期","type":"doc","updated":"20251020230922"},"Children":[{"ID":"20251020222903-qhd3x11","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251020222903-qhd3x11","updated":"20251020223744"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/lifetime/advance.html#%E4%B8%8D%E5%A4%AA%E8%81%AA%E6%98%8E%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%A3%80%E6%9F%A5","TextMarkTextContent":"不太聪明的生命周期检查"}]},{"ID":"20251020222903-p94cyie","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251020222903-p94cyie","updated":"20251020222932"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"#![allow(unused)]\nfn main() {\n    use std::collections::HashMap;\n    use std::hash::Hash;\n    fn get_default\u003c'm, K, V\u003e(map: \u0026'm mut HashMap\u003cK, V\u003e, key: K) -\u003e \u0026'm mut V\n    where\n        K: Clone + Eq + Hash,\n        V: Default,\n    {\n        match map.get_mut(\u0026key) {   //引用一次\n            Some(value) =\u003e value,\n            None =\u003e {\n                map.insert(key.clone(), V::default());\n                map.get_mut(\u0026key).unwrap()  //引用第二次\n            }\n        }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251020223748-seibm3r","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251020223748-seibm3r","updated":"20251020225100"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/lifetime/advance.html#%E6%97%A0%E7%95%8C%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F","TextMarkTextContent":"无界生命周期"},{"Type":"NodeText","Data":"：UNSAFE"}]},{"ID":"20251020223749-lyjkdac","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251020223749-lyjkdac","updated":"20251020225057"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"fn f\u003c'a, T\u003e(x: *const T) -\u003e \u0026'a T {\n    unsafe {\n        \u0026*x  //输入并没有生命周期，但是解引用指针，再转换引用，就变成了 \u0026T， 这里T有生命周期，所以是\u0026'a T\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251020225129-5mpvchr","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251020225129-5mpvchr","updated":"20251020230922"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/lifetime/advance.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%BA%A6%E6%9D%9F-hrtb","TextMarkTextContent":"生命周期约束 HRTB"}]},{"ID":"20251020225133-wjirsjv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251020225133-wjirsjv","updated":"20251020230922"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"'a: 'b \t表示 'a 至少要活得跟 'b 一样久。\n\tstruct DoubleRef\u003c'a,'b:'a, T\u003e {\n\t    r: \u0026'a T,\n\t    s: \u0026'b T\n\t}\nT: 'a  表示类型 T 必须比 'a 活得要久\n\tstruct Ref\u003c'a, T: 'a\u003e {\n\t    r: \u0026'a T\n\t}\n\t但是1.3.1编译器会推导\n\tstruct Ref\u003c'a, T\u003e {\n\t    r: \u0026'a T\n\t}\n例子：\nstruct ImportantExcerpt\u003c'a\u003e {\n    part: \u0026'a str,\n}\n\nimpl\u003c'a: 'b, 'b\u003e ImportantExcerpt\u003c'a\u003e { \n    fn announce_and_return_part(\u0026'a self, announcement: \u0026'b str) -\u003e \u0026'b str {   //'b作为结构体的引用，机构体的内引用生命周期又是'a，约束'b不能大于'a\n        println!(\"Attention please: {}\", announcement);\n        self.part\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251020225406-uoyj2un","Type":"NodeParagraph","Properties":{"id":"20251020225406-uoyj2un","updated":"20251020225406"}}]}
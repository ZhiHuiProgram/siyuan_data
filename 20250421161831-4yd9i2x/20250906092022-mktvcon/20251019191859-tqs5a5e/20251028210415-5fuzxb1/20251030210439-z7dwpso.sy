{"ID":"20251030210439-z7dwpso","Spec":"1","Type":"NodeDocument","Properties":{"id":"20251030210439-z7dwpso","title":"Drop é‡Šæ”¾èµ„æº","type":"doc","updated":"20251030213757"},"Children":[{"ID":"20251030210439-1nh3qet","Type":"NodeParagraph","Properties":{"id":"20251030210439-1nh3qet","updated":"20251030212337"},"Children":[{"Type":"NodeText","Data":"Dropç‰¹å¾é‡Šæ”¾"}]},{"ID":"20251030212337-dkibewd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251030212337-dkibewd","updated":"20251030212405"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"struct HasDrop1;\nstruct HasDrop2;\nimpl Drop for HasDrop1 {\n    fn drop(\u0026mut self) {\n        println!(\"Dropping HasDrop1!\");\n    }\n}\nimpl Drop for HasDrop2 {\n    fn drop(\u0026mut self) {\n        println!(\"Dropping HasDrop2!\");\n    }\n}\nstruct HasTwoDrops {\n    one: HasDrop1,\n    two: HasDrop2,\n}\nimpl Drop for HasTwoDrops {\n    fn drop(\u0026mut self) {\n        println!(\"Dropping HasTwoDrops!\");\n    }\n}\n\nstruct Foo;\n\nimpl Drop for Foo {\n    fn drop(\u0026mut self) {\n        println!(\"Dropping Foo!\")\n    }\n}\n\nfn main() {\n    let _x = HasTwoDrops {\n        two: HasDrop2,\n        one: HasDrop1,\n    };\n    let _foo = Foo;\n    println!(\"Running!\");\n}\n\nè¾“å‡ºï¼š\n\tRunning!\n\tDropping Foo!\n\tDropping HasTwoDrops!\n\tDropping HasDrop1!\n\tDropping HasDrop2!\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251030212415-qu882sj","Type":"NodeList","ListData":{},"Properties":{"id":"20251030212415-qu882sj","updated":"20251030212415"},"Children":[{"ID":"20251030212415-qtbks8h","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20251030212415-qtbks8h","updated":"20251030212415"},"Children":[{"ID":"20251030212415-bp6o1nz","Type":"NodeParagraph","Properties":{"id":"20251030212415-bp6o1nz","updated":"20251030212415"},"Children":[{"Type":"NodeText","Data":"â€‹"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"å˜é‡çº§åˆ«ï¼ŒæŒ‰ç…§é€†åºçš„æ–¹å¼"},{"Type":"NodeText","Data":"â€‹ï¼Œ"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_x"},{"Type":"NodeText","Data":"â€‹ åœ¨ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_foo"},{"Type":"NodeText","Data":"â€‹ ä¹‹å‰åˆ›å»ºï¼Œå› æ­¤ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_x"},{"Type":"NodeText","Data":"â€‹ åœ¨ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_foo"},{"Type":"NodeText","Data":"â€‹ ä¹‹åè¢« "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"drop"},{"Type":"NodeText","Data":"â€‹"}]}]},{"ID":"20251030212415-y233xvp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20251030212415-y233xvp","updated":"20251030212415"},"Children":[{"ID":"20251030212415-hfq84gz","Type":"NodeParagraph","Properties":{"id":"20251030212415-hfq84gz","updated":"20251030212415"},"Children":[{"Type":"NodeText","Data":"â€‹"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"ç»“æ„ä½“å†…éƒ¨ï¼ŒæŒ‰ç…§é¡ºåºçš„æ–¹å¼"},{"Type":"NodeText","Data":"â€‹ï¼Œç»“æ„ä½“ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_x"},{"Type":"NodeText","Data":"â€‹ ä¸­çš„å­—æ®µæŒ‰ç…§å®šä¹‰ä¸­çš„é¡ºåºä¾æ¬¡ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"drop"},{"Type":"NodeText","Data":"â€‹"}]}]}]},{"ID":"20251030212714-q52s0he","Type":"NodeParagraph","Properties":{"id":"20251030212714-q52s0he","updated":"20251030212714"},"Children":[{"Type":"NodeText","Data":"åŸå› åœ¨äºï¼ŒRust è‡ªåŠ¨ä¸ºå‡ ä¹æ‰€æœ‰ç±»å‹éƒ½å®ç°äº† Drop ç‰¹å¾ï¼Œå› æ­¤å°±ç®—ä½ ä¸æ‰‹åŠ¨ä¸ºç»“æ„ä½“å®ç° Dropï¼Œå®ƒä¾ç„¶ä¼šè°ƒç”¨é»˜è®¤å®ç°çš„ drop å‡½æ•°ï¼ŒåŒæ—¶å†è°ƒç”¨æ¯ä¸ªå­—æ®µçš„ drop æ–¹æ³•ï¼Œæœ€ç»ˆæ‰“å°å‡ºï¼š"}]},{"ID":"20251030212717-9m2eaex","Type":"NodeParagraph","Properties":{"id":"20251030212717-9m2eaex","updated":"20251030212718"},"Children":[{"Type":"NodeText","Data":"Dropping HasDrop1!\nDropping HasDrop2!"}]},{"ID":"20251030212910-xphlsfw","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251030212910-xphlsfw","updated":"20251030213121"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/smart-pointer/drop.html#%E6%89%8B%E5%8A%A8%E5%9B%9E%E6%94%B6","TextMarkTextContent":"æ‰‹åŠ¨å›æ”¶"}]},{"ID":"20251030212910-7ld36ad","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251030212910-7ld36ad","updated":"20251030213021"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"#[derive(Debug)]\nstruct Foo;\n\nimpl Drop for Foo {\n    fn drop(\u0026mut self) {\n        println!(\"Dropping Foo!\")\n    }\n}\n\nfn main() {\n    let foo = Foo;\n    foo.drop();\n    println!(\"Running!:{:?}\", foo);\n} //ä¸å…è®¸ï¼Œä¸å…è®¸æ˜¾å¼åœ°è°ƒç”¨dropç‰¹å¾æ–¹æ³• \nDrop::drop åªæ˜¯å€Ÿç”¨äº†ç›®æ ‡å€¼çš„å¯å˜å¼•ç”¨ï¼Œæ‰€ä»¥ï¼Œå°±ç®—ä½ æå‰è°ƒç”¨äº† dropï¼Œåé¢çš„ä»£ç ä¾ç„¶å¯ä»¥ä½¿ç”¨ç›®æ ‡å€¼\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251030213005-z7u4lfd","Type":"NodeParagraph","Properties":{"id":"20251030213005-z7u4lfd","updated":"20251030213028"},"Children":[{"Type":"NodeText","Data":"å®ç°"}]},{"ID":"20251030213028-oqqbcdj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251030213028-oqqbcdj","updated":"20251030213121"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"pub fn drop\u003cT\u003e(_x: T)\n\nfn main() {\n    let foo = Foo;\n    drop(foo);\n    // ä»¥ä¸‹ä»£ç ä¼šæŠ¥é”™ï¼šå€Ÿç”¨äº†æ‰€æœ‰æƒè¢«è½¬ç§»çš„å€¼\n    // println!(\"Running!:{:?}\", foo);\n}\ndrop(_x)å‡½æ•°åªæ˜¯ä¸ªç©ºå‡½æ•°\nç”±äºå…¶æŒæœ‰ç›®æ ‡å€¼çš„æ‰€æœ‰æƒï¼Œåœ¨drop(_x)å‡½æ•°ç»“æŸä¹‹é™…ï¼Œç¼–è¯‘å™¨ä¼šæ‰§è¡Œ_xçœŸæ­£çš„ææ„å‡½æ•°\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251030213250-s84vw65","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251030213250-s84vw65","updated":"20251030213315"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/smart-pointer/drop.html#drop-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF","TextMarkTextContent":"Drop ä½¿ç”¨åœºæ™¯"}]},{"ID":"20251030213300-bwfg54y","Type":"NodeList","ListData":{},"Properties":{"id":"20251030213300-bwfg54y","updated":"20251030213300"},"Children":[{"ID":"20251030213300-0eahqmj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20251030213300-0eahqmj","updated":"20251030213300"},"Children":[{"ID":"20251030213300-fj7xyeo","Type":"NodeParagraph","Properties":{"id":"20251030213300-fj7xyeo","updated":"20251030213300"},"Children":[{"Type":"NodeText","Data":"å›æ”¶å†…å­˜èµ„æº"}]}]},{"ID":"20251030213300-zma2zks","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20251030213300-zma2zks","updated":"20251030213300"},"Children":[{"ID":"20251030213300-pev24e5","Type":"NodeParagraph","Properties":{"id":"20251030213300-pev24e5","updated":"20251030213300"},"Children":[{"Type":"NodeText","Data":"æ‰§è¡Œä¸€äº›æ”¶å°¾å·¥ä½œ"}]}]}]},{"ID":"20251030213250-e4w7vci","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251030213250-e4w7vci","updated":"20251030213314"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"æœ‰æå°‘æ•°æƒ…å†µï¼Œéœ€è¦ä½ è‡ªå·±æ¥å›æ”¶èµ„æºçš„ï¼Œä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦ã€ç½‘ç»œ socket ç­‰ï¼Œå½“è¿™äº›å€¼è¶…å‡ºä½œç”¨åŸŸä¸å†ä½¿ç”¨æ—¶ï¼Œå°±éœ€è¦è¿›è¡Œå…³é—­ä»¥é‡Šæ”¾ç›¸å…³çš„èµ„æº\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20251030213741-admodt9","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251030213741-admodt9","updated":"20251030213757"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://course.rs/advance/smart-pointer/drop.html#%E4%BA%92%E6%96%A5%E7%9A%84-copy-%E5%92%8C-drop","TextMarkTextContent":"äº’æ–¥çš„ Copy å’Œ Drop"}]},{"ID":"20251030213742-s8svrmo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20251030213742-s8svrmo","updated":"20251030213757"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aWZjb25maWc="},{"Type":"NodeCodeBlockCode","Data":"æ— æ³•ä¸ºä¸€ä¸ªç±»å‹åŒæ—¶å®ç° Copy å’Œ Drop ç‰¹å¾\n\n// âš ï¸ å‡è®¾çš„ä»£ç ï¼ˆå®é™…æ— æ³•ç¼–è¯‘ï¼‰\n#[derive(Copy, Clone)]\nstruct FileHandle {\n    fd: i32,  // æ–‡ä»¶æè¿°ç¬¦\n}\n\nimpl Drop for FileHandle {\n    fn drop(\u0026mut self) {\n        println!(\"å…³é—­æ–‡ä»¶æè¿°ç¬¦ {}\", self.fd);\n        // å®é™…ä¼šè°ƒç”¨ close(self.fd)\n    }\n}\n\nfn main() {\n    let handle1 = FileHandle { fd: 42 };\n    let handle2 = handle1;  // Copyï¼šéšå¼å¤åˆ¶\n    let handle3 = handle1;  // å†æ¬¡ Copy\n    \n    // ç°åœ¨æœ‰ä¸‰ä¸ª FileHandleï¼Œéƒ½æœ‰ç›¸åŒçš„ fd: 42\n    // å½“å®ƒä»¬ç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n}\n// ğŸ’¥ é—®é¢˜ï¼š\n// - Drop ä¼šè¢«è°ƒç”¨ 3 æ¬¡ï¼\n// - åŒä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦è¢«å…³é—­ 3 æ¬¡\n// - ç¬¬ 2ã€3 æ¬¡å…³é—­ä¼šå¤±è´¥ï¼ˆdouble-free ç±»ä¼¼çš„é—®é¢˜ï¼‰\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}